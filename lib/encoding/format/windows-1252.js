var EncodingError = require("../error.js");

var dec_tbl = {
		0x80:0x20AC,
		0x81:null,
		0x82:0x201A,
		0x83:0x0192,
		0x84:0x201E,
		0x85:0x2026,
		0x86:0x2020,
		0x87:0x2021,
		0x88:0x02C6,
		0x89:0x2030,
		0x8A:0x0160,
		0x8B:0x2039,
		0x8C:0x0152,
		0x8D:null,
		0x8E:0x017D,
		0x8F:null,
		0x90:null,
		0x91:0x2018,
		0x92:0x2019,
		0x93:0x201C,
		0x94:0x201D,
		0x95:0x2022,
		0x96:0x2013,
		0x97:0x2014,
		0x98:0x02DC,
		0x99:0x2122,
		0x9A:0x0161,
		0x9B:0x203A,
		0x9C:0x0153,
		0x9D:null,
		0x9E:0x017E,
		0x9F:0x0178
	},
	enc_tbl = {};

for (var i = 0; i < 0x100; i++) {
	if (dec_tbl[i]) {
		if (dec_tbl[i] !== null) {
			enc_tbl[dec_tbl[i]] = i;
		}
		continue ;
	}
	enc_tbl[i] = dec_tbl[i] = i;
}

function replace(tbl, arr) {
	return arr.map(function (v) {
		if (typeof tbl[v] !== 'number') {
			throw new EncodingError("Invalid windows-1252 character " + v.toString(16));
		}

		return tbl[v];
	});
}

module.exports = {
	encode: replace.bind(null, enc_tbl),
	decode: replace.bind(null, dec_tbl)
};
